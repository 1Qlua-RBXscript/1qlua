local player = game.Players.LocalPlayer

--=== –ù–ê–°–¢–†–û–ô–ö–ò ===--
local settings = {
    SoundFile = "ZXCUR$EDDDemonvgolove2.mp3",  -- –ò–º—è —Ñ–∞–π–ª–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    SoundUrl = "https://cdn.discordapp.com/attachments/1390426824345125036/1395901831841845349/ZXCUREDD_-_2.mp3?ex=687c2263&is=687ad0e3&hm=115bf2e4c92c0b431934fc44ec4f34b89950239b86e4d8dce6bc72c5f8e1365c&",  -- –°—Å—ã–ª–∫–∞ –Ω–∞ –∞—É–¥–∏–æ
    DefaultVolume = 2,           -- –ì—Ä–æ–º–∫–æ—Å—Ç—å (0.1 - 1)
    LoopEnabled = false,            -- –ü–æ–≤—Ç–æ—Ä—è—Ç—å —Ç—Ä–µ–∫
    AutoPlay = true,               -- –ê–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
    ChatCommands = {               -- –ö–æ–º–∞–Ω–¥—ã –≤ —á–∞—Ç–µ
        Play = "/play",            -- –í–∫–ª—é—á–∏—Ç—å
        Stop = "/stop",            -- –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
        VolumeUp = "/vol+",        -- –ì—Ä–æ–º–∫–æ—Å—Ç—å +
        VolumeDown = "/vol-",      -- –ì—Ä–æ–º–∫–æ—Å—Ç—å -
        ToggleLoop = "/loop"       -- –í–∫–ª/–í—ã–∫–ª –ø–æ–≤—Ç–æ—Ä
    }
}
--=================--

-- –ó–∞–≥—Ä—É–∂–∞–µ–º –∞—É–¥–∏–æ—Ñ–∞–π–ª (–µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç)
if not isfile(settings.SoundFile) then
    writefile(settings.SoundFile, game:HttpGet(settings.SoundUrl))
end

-- –û–∂–∏–¥–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
local character = player.Character or player.CharacterAdded:Wait()
local rootPart = character:WaitForChild("HumanoidRootPart")

-- –°–æ–∑–¥–∞–µ–º –∑–≤—É–∫–æ–≤–æ–π –æ–±—ä–µ–∫—Ç
local sound = Instance.new("Sound")
sound.SoundId = getcustomasset(settings.SoundFile)
sound.Volume = settings.DefaultVolume
sound.Looped = settings.LoopEnabled
sound.Parent = rootPart

-- –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
local function playSound()
    if not sound.IsPlaying then
        sound:Play()
        return "üîä –ú—É–∑—ã–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞!"
    end
    return "‚ö†Ô∏è –ú—É–∑—ã–∫–∞ —É–∂–µ –∏–≥—Ä–∞–µ—Ç"
end

local function stopSound()
    if sound.IsPlaying then
        sound:Stop()
        return "‚èπÔ∏è –ú—É–∑—ã–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
    end
    return "‚ö†Ô∏è –ú—É–∑—ã–∫–∞ —É–∂–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
end

local function setVolume(change)
    local newVolume = math.clamp(sound.Volume + change, 0.1, 1)
    sound.Volume = newVolume
    return "üîâ –ì—Ä–æ–º–∫–æ—Å—Ç—å: " .. string.format("%.1f", newVolume)
end

local function toggleLoop()
    sound.Looped = not sound.Looped
    return "üîÑ –ü–æ–≤—Ç–æ—Ä: " .. (sound.Looped and "–í–ö–õ" or "–í–´–ö–õ")
end

-- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —á–∞—Ç-–∫–æ–º–∞–Ω–¥
player.Chatted:Connect(function(msg)
    local response
    if msg == settings.ChatCommands.Play then
        response = playSound()
    elseif msg == settings.ChatCommands.Stop then
        response = stopSound()
    elseif msg == settings.ChatCommands.VolumeUp then
        response = setVolume(0.1)
    elseif msg == settings.ChatCommands.VolumeDown then
        response = setVolume(-0.1)
    elseif msg == settings.ChatCommands.ToggleLoop then
        response = toggleLoop()
    end
    
    if response then
        print(response)
    end
end)

-- –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫
if settings.AutoPlay then
    playSound()
end

-- –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ
game:GetService("Players").PlayerRemoving:Connect(function(p)
    if p == player then stopSound() end
end)
