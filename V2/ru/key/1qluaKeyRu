local LibraryUrl = "https://raw.githubusercontent.com/1Qlua-RBXscript/1qlua/refs/heads/main/labar"
if not game:IsLoaded() then game.Loaded:Wait() end
local player = game.Players.LocalPlayer
local Success, Library = pcall(function()
    return loadstring(game:HttpGet(LibraryUrl))()
end)
if not Success or not Library then 
    return warn("Error loading UI library!") 
end
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
Library:Watermark("| >ᴗ< | ♡1Qlua♡ (Хаб) | >ᴗ< |  v12 | >ᴗ< ")
local Window = Library:Window("| 1Qlua ♡ Хаб |")

-- функций
-- музыка
-- Настройки музыки

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local SoundService = game:GetService("SoundService")

local settings = {
    SoundFile = "cat.mp3",
    SoundUrl = "https://cdn.discordapp.com/attachments/1374346480130719744/1455053866943910164/the_living_tombstone_-_Cats_slowedreverb_-_GemanTyoma_youtube.mp3?ex=69535403&is=69520283&hm=707c5099eda0ed08a13a1c43c222560b62795aea96d8ec440b2deadf2111616c&",
    DefaultVolume = 0.5,
    LoopEnabled = true,
    AutoPlay = true,
}
local sound = nil
local isMusicLoaded = false
local isPlaying = false
local currentVolume = 0.5
local isLooped = true
local musicToggle = nil

local function initializeMusic()
    if not isMusicLoaded then
        if not isfile(settings.SoundFile) then
            writefile(settings.SoundFile, game:HttpGet(settings.SoundUrl))
        end
        sound = Instance.new("Sound")
        sound.SoundId = getcustomasset(settings.SoundFile)
        sound.Volume = currentVolume
        sound.Looped = isLooped
        sound.Parent = SoundService
        isMusicLoaded = true
        return true
    end
    return false
end
local function playMusic()
    if sound and not sound.IsPlaying then
        sound:Play()
        isPlaying = true
        return true
    end
    return false
end
local function stopMusic()
    if sound and sound.IsPlaying then
        sound:Stop()
        isPlaying = false
        return true
    end
    return false
end
local function toggleMusic()
    if sound then
        if sound.IsPlaying then
            sound:Stop()
            isPlaying = false
            return false
        else
            sound:Play()
            isPlaying = true
            return true
        end
    end
    return false
end
local function setVolume(newVolume)
    currentVolume = newVolume
    if sound then
        sound.Volume = currentVolume
    end
end
task.spawn(function()
    task.wait(1)
    local loaded = initializeMusic()
    
    if loaded then
        task.wait(2) 
        if settings.AutoPlay then
            if playMusic() then
                if musicToggle then
                    musicToggle:Set(true)
                end
            end
        end
    end
end)

game:GetService("Players").PlayerRemoving:Connect(function(player)
    if player == LocalPlayer and sound then
        sound:Stop()
        sound:Destroy()
    end
end)
local walkflinging = false
local antifling = nil
local function enableWalkFling()
    if walkflinging then return end
    walkflinging = true
    task.spawn(function()
        local RunService = game:GetService("RunService")
        local LocalPlayer = game.Players.LocalPlayer
        while walkflinging do
            RunService.Heartbeat:Wait()
            local char = LocalPlayer.Character
            local root = char and char:FindFirstChild("HumanoidRootPart")
            if root then
                local vel = root.Velocity
                root.Velocity = vel * 10000 + Vector3.new(0, 10000, 0)
                
                RunService.RenderStepped:Wait()
                if root then
                    root.Velocity = vel
                end
            end
        end
    end)
end
local function disableWalkFling()
    walkflinging = false
end
local function enableAntiFling()
    if antifling then
        antifling:Disconnect()
    end
    antifling = game:GetService("RunService").Stepped:Connect(function()
        for _, player in pairs(game:GetService("Players"):GetPlayers()) do
            if player ~= game.Players.LocalPlayer and player.Character then
                for _, v in pairs(player.Character:GetDescendants()) do
                    if v:IsA("BasePart") then
                        v.CanCollide = false
                    end
                end
            end
        end
    end)
end
local function disableAntiFling()
    if antifling then
        antifling:Disconnect()
        antifling = nil
    end
end
-- ТУТ НАЧАЛО ДРУГОЙ ФУНКЦИИ
-- это если что игроки
local SelectedPlayer = nil
local PlayerESP = {}
local Spectating = false
local OriginalCameraSubject = nil
local ESPEnabled = false
local AvatarCache = {}
local PlayerSelectionGUI = Instance.new("ScreenGui")
PlayerSelectionGUI.Name = "PlayerSelector"
PlayerSelectionGUI.ResetOnSpawn = false
PlayerSelectionGUI.ZIndexBehavior = Enum.ZIndexBehavior.Global  
if syn then
    PlayerSelectionGUI.Parent = syn.protect_gui and syn.protect_gui(PlayerSelectionGUI) or game:GetService("CoreGui")
else
    PlayerSelectionGUI.Parent = game:GetService("CoreGui")
end
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 350, 0, 450)
MainFrame.Position = UDim2.new(0.5, -175, 0.5, -225)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Visible = false
MainFrame.ZIndex = 100 
MainFrame.Parent = PlayerSelectionGUI
local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0, 6)
UICorner.Parent = MainFrame
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 40)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Title.Text = "Выберите игрока"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.Gotham
Title.TextSize = 16
Title.ZIndex = 101
Title.Parent = MainFrame
local CloseButton = Instance.new("TextButton")
CloseButton.Size = UDim2.new(0, 30, 0, 30)
CloseButton.Position = UDim2.new(1, -35, 0, 5)
CloseButton.Text = "X"
CloseButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
CloseButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseButton.Font = Enum.Font.GothamBold
CloseButton.TextSize = 14
CloseButton.ZIndex = 101
CloseButton.Parent = MainFrame
local SearchBox = Instance.new("TextBox")
SearchBox.Size = UDim2.new(1, -20, 0, 30)
SearchBox.Position = UDim2.new(0, 10, 0, 50)
SearchBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
SearchBox.TextColor3 = Color3.fromRGB(255, 255, 255)
SearchBox.PlaceholderText = "Поиск игрока..."
SearchBox.Font = Enum.Font.Gotham
SearchBox.TextSize = 14
SearchBox.Text = "" 
SearchBox.ZIndex = 101
SearchBox.Parent = MainFrame
local SearchBoxCorner = Instance.new("UICorner")
SearchBoxCorner.CornerRadius = UDim.new(0, 4)
SearchBoxCorner.Parent = SearchBox
local PlayersFrame = Instance.new("ScrollingFrame")
PlayersFrame.Size = UDim2.new(1, -20, 1, -100)
PlayersFrame.Position = UDim2.new(0, 10, 0, 90)
PlayersFrame.BackgroundTransparency = 1
PlayersFrame.ScrollBarThickness = 5
PlayersFrame.ZIndex = 101
PlayersFrame.Parent = MainFrame
local UIListLayout = Instance.new("UIListLayout")
UIListLayout.Padding = UDim.new(0, 5)
UIListLayout.Parent = PlayersFrame
local function GetPlayerAvatar(player)
    local userId = player.UserId
    if AvatarCache[userId] then
        return AvatarCache[userId]
    end
    local success, result = pcall(function()
        return game:GetService("Players"):GetUserThumbnailAsync(userId, Enum.ThumbnailType.HeadShot, Enum.ThumbnailSize.Size100x100)
    end)
    if success and result then
        AvatarCache[userId] = result
        return result
    end
    return "rbxasset://textures/ui/GuiImagePlaceholder.png"
end
local function CreatePlayerButton(player)
    local PlayerButton = Instance.new("Frame")
    PlayerButton.Size = UDim2.new(1, 0, 0, 50)
    PlayerButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    PlayerButton.ZIndex = 102
    PlayerButton.Parent = PlayersFrame
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(0, 4)
    ButtonCorner.Parent = PlayerButton
    local Avatar = Instance.new("ImageLabel")
    Avatar.Size = UDim2.new(0, 40, 0, 40)
    Avatar.Position = UDim2.new(0, 5, 0.5, -20)
    Avatar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    Avatar.Image = GetPlayerAvatar(player)
    Avatar.ZIndex = 103
    Avatar.Parent = PlayerButton
    local AvatarCorner = Instance.new("UICorner")
    AvatarCorner.CornerRadius = UDim.new(0, 4)
    AvatarCorner.Parent = Avatar
    local PlayerName = Instance.new("TextLabel")
    PlayerName.Size = UDim2.new(1, -55, 1, 0)
    PlayerName.Position = UDim2.new(0, 50, 0, 0)
    PlayerName.BackgroundTransparency = 1
    PlayerName.Text = player.Name
    PlayerName.TextColor3 = Color3.fromRGB(255, 255, 255)
    PlayerName.Font = Enum.Font.Gotham
    PlayerName.TextSize = 14
    PlayerName.TextXAlignment = Enum.TextXAlignment.Left
    PlayerName.ZIndex = 103
    PlayerName.Parent = PlayerButton
    local SelectButton = Instance.new("TextButton")
    SelectButton.Size = UDim2.new(1, 0, 1, 0)
    SelectButton.BackgroundTransparency = 1
    SelectButton.Text = ""
    SelectButton.ZIndex = 104
    SelectButton.Parent = PlayerButton
    SelectButton.MouseButton1Click:Connect(function()
        SelectedPlayer = player
        MainFrame.Visible = false
    end)
    return PlayerButton
end
local function UpdatePlayerList()
    for _, child in pairs(PlayersFrame:GetChildren()) do
        if child:IsA("Frame") then
            child:Destroy()
        end
    end
    local searchText = string.lower(SearchBox.Text)
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local playerName = string.lower(player.Name)
            if searchText == "" or string.find(playerName, searchText, 1, true) then
                CreatePlayerButton(player)
            end
        end
    end
end
local function TeleportToPlayer()
    if SelectedPlayer and SelectedPlayer.Character and SelectedPlayer.Character:FindFirstChild("HumanoidRootPart") then
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            LocalPlayer.Character.HumanoidRootPart.CFrame = SelectedPlayer.Character.HumanoidRootPart.CFrame
        end
    end
end
local function ToggleESP(state)
    ESPEnabled = state
    if not state then
        for _, esp in pairs(PlayerESP) do
            if esp then
                esp:Destroy()
            end
        end
        PlayerESP = {}
    elseif SelectedPlayer then
        if PlayerESP[SelectedPlayer] then
            PlayerESP[SelectedPlayer]:Destroy()
            PlayerESP[SelectedPlayer] = nil
        end
        if SelectedPlayer.Character then
            local highlight = Instance.new("Highlight")
            highlight.OutlineTransparency = 0
            highlight.FillTransparency = 0.5
            highlight.FillColor = Color3.fromRGB(255, 0, 0)
            highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
            highlight.Parent = SelectedPlayer.Character
            PlayerESP[SelectedPlayer] = highlight
        end
    end
end
local function ToggleSpectate(state)
    Spectating = state
    if state and SelectedPlayer and SelectedPlayer.Character then
        OriginalCameraSubject = Camera.CameraSubject
        Camera.CameraSubject = SelectedPlayer.Character:FindFirstChildOfCl
