local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

--// ======== ИСПРАВЛЕННАЯ ТЕЛЕПОРТАЦИЯ ======== //--
getgenv().TP = function(...)
    local args = {...}
    local x, y, z
    
    -- Обработка разных форматов ввода
    if #args == 1 then
        -- Вариант 1: Строка "x,y,z"
        if type(args[1]) == "string" then
            local coords = {}
            for num in args[1]:gmatch("-?%d+") do
                table.insert(coords, tonumber(num))
            end
            if #coords ~= 3 then
                warn("❌ Нужно 3 координаты через запятую")
                return false
            end
            x, y, z = coords[1], coords[2], coords[3]
        
        -- Вариант 2: Таблица {x, y, z}
        elseif type(args[1]) == "table" then
            if #args[1] ~= 3 then
                warn("❌ Нужно 3 координаты в таблице")
                return false
            end
            x, y, z = args[1][1], args[1][2], args[1][3]
        
        -- Вариант 3: Путь к объекту
        else
            local target = findObject(args[1])
            if not target then
                warn("❌ Объект не найден: " .. args[1])
                return false
            end
            
            if target:IsA("BasePart") then
                HumanoidRootPart.CFrame = target.CFrame * CFrame.new(0, 3, 0)
            elseif target:IsA("Model") then
                local part = target.PrimaryPart or target:FindFirstChildWhichIsA("BasePart")
                if part then
                    HumanoidRootPart.CFrame = part.CFrame * CFrame.new(0, 3, 0)
                else
                    warn("❌ У модели нет частей для телепортации")
                    return false
                end
            else
                warn("❌ Объект не является частью или моделью")
                return false
            end
            print("✅ Телепортация к: " .. args[1])
            return true
        end
    elseif #args == 3 then
        -- Вариант 4: Три отдельных числа
        x, y, z = args[1], args[2], args[3]
    else
        warn("❌ Неверный формат. Используйте: TP(x,y,z) или TP(\"x,y,z\")")
        return false
    end

    -- Проверка координат
    if not x or not y or not z then
        warn("❌ Координаты должны быть числами")
        return false
    end

    -- Телепортация
    HumanoidRootPart.CFrame = CFrame.new(x, y, z)
    print(string.format("✅ Телепортация к координатам: %d, %d, %d", x, y, z))
    return true
end
